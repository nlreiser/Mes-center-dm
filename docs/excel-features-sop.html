<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Excel Features SOP | Mesulam Center Data Management Practices</title>
<meta name="author" content="Nina Reiser">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 3 Excel Features SOP | Mesulam Center Data Management Practices">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Excel Features SOP | Mesulam Center Data Management Practices">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
<meta name="description" content="This document functions as an instruction manual for Excel features commonly used after a REDCap Report is downloaded. All examples were created using the az_demo and az_test datasets, which...">
<meta property="og:description" content="This document functions as an instruction manual for Excel features commonly used after a REDCap Report is downloaded. All examples were created using the az_demo and az_test datasets, which...">
<meta name="twitter:description" content="This document functions as an instruction manual for Excel features commonly used after a REDCap Report is downloaded. All examples were created using the az_demo and az_test datasets, which...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Mesulam Center Data Management Practices</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="ripple-sop.html"><span class="header-section-number">2</span> Ripple SOP</a></li>
<li><a class="active" href="excel-features-sop.html"><span class="header-section-number">3</span> Excel Features SOP</a></li>
<li><a class="" href="data-request-sop.html"><span class="header-section-number">4</span> Data Request SOP</a></li>
<li><a class="" href="redcap-reports-sop.html"><span class="header-section-number">5</span> REDCap Reports SOP</a></li>
<li><a class="" href="sharepoint-sop.html"><span class="header-section-number">6</span> SharePoint SOP</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/nlreiser/Mes-center-dm/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="excel-features-sop" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Excel Features SOP<a class="anchor" aria-label="anchor" href="#excel-features-sop"><i class="fas fa-link"></i></a>
</h1>
<p>This document functions as an instruction manual for Excel features commonly
used after a REDCap Report is downloaded. All examples were created using the az_demo and az_test datasets, which contain computer-generated sample data via the <i>randomNames</i> R package.</p>
<p><b>Note:</b> <i>An important step to conserve the order of the original data is to add an
index column. Left click the first column. Select ‘Insert’ from the dropdown.
Title the new column ‘Index’. Enter a 1 in the first row with data, a 2 to the
second row, and a 3 to the third row. Select the cells with the 1, 2, and 3
indexes. Double-click on the small box on the lower right-hand side of the
selected cells, which will auto-populate index values for all rows that contain
data.</i></p>
<div id="find" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Find<a class="anchor" aria-label="anchor" href="#find"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Highlight the data you wish to search. Use the shortcut ‘Ctrl + F’ on a
Windows or ‘Cmd + F’ on a Mac OR select the magnifying glass icon
<img src="search_icon_excel.png" width="7%" style="background-color: #41444B; padding:2px;">
in the navigation pane.</li>
<li>Enter the search keywords into the search bar and press enter to view.</li>
<li>Continuing to press enter will cycle through all locations of the search keyword in the spreadsheet.
Ex:
<img src="search_bar_excel.png" width="40%" style="background-color: #41444B; padding:2px;">
</li>
<li>For a more advanced search, use the ‘Advanced Search’ window.
<img src="advanced_search_excel.png" width="105%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</div>
<div id="find-replace" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Find &amp; Replace<a class="anchor" aria-label="anchor" href="#find-replace"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Highlight the data you wish to search and replace. This can include a single
or multiple columns, or the entire spreadsheet.</p></li>
<li><p>Use the shortcut ‘Ctrl + F’ on a
Windows or ‘Cmd + F’ on a Mac OR select the magnifying glass icon
<img src="search_icon_excel.png" width="7%" style="background-color: #41444B; padding:2px;">
in the navigation pane and select ‘Replace…’ from the dropdown.
<img src="replace_button_excel.png" width="15%" style="background-color: #41444B; padding:2px;"></p></li>
<li><p>Enter the search keywords into the ‘Find what’ search bar.</p></li>
<li><div class="inline-figure">Enter the replacement into the ‘Replace with’ search bar.
Ex: Replace a diagnosis acronym with the full name.
<img src="find_and_replace_excel.png" width="90%" style="background-color: #41444B; padding:2px;">
</div></li>
<li><p>Click ‘Replace’ for a single cell replacement or ‘Replace All’ to replace all selected data.</p></li>
</ol>
</div>
<div id="sort-data" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Sort Data<a class="anchor" aria-label="anchor" href="#sort-data"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>To Sort or Filter data, begin by selecting the columns or rows you wish to
filter. To add filters to all columns, click the downward triangle icon
<img src="select_all_excel.png" width="5%" style="background-color: #FFFFFF; padding:2px;">
in the upper lefthand corner of the spreadsheet. This selects all data in the spreadsheet.</li>
<li>Navigate to the Editing dropdown on the Home tab in Excel.
<img src="sort_options_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>Click ‘Sort &amp; Filter’ for a dropdown and select one of the three sort options:
<ol style="list-style-type: lower-alpha">
<li>‘Sort A to Z’ sorts alphabetically or numerically in ascending order.</li>
<li>‘Sort Z to A’ sorts alphabetically or numerically in descending order.</li>
<li>‘Custom Sort…’ opens a window for further sorting criteria.
<img src="custom_sort_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
</ol>
<p>Ex: Sort all data first by date of birth, then by race. Select the column ‘dob’
and order ‘Oldest to Newest’. Then select the ‘+’ to add another sort criteria.
Select the column ‘race’ and order ‘A to Z’.</p>
<div class="inline-figure"><img src="sort_order_excel.png" width="70%" style="background-color: #41444B; padding:2px;"></div>
<ol start="4" style="list-style-type: decimal">
<li>Enter all sorting criteria, then select ‘OK’. The selected data will now be sorted using your desired order.</li>
<li>To revert to original order, sort by the index column in ascending order.</li>
</ol>
</div>
<div id="filter-data" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Filter Data<a class="anchor" aria-label="anchor" href="#filter-data"><i class="fas fa-link"></i></a>
</h2>
<p><i>Filters can be used to obtain desired data or remove unwanted data. With the
filter tool, the user can specify column criteria they would like to be met and
view only those rows. To remove unwanted data from a spreadsheet, filter the data
to obtain what is NOT wanted,
then delete those rows. When the ‘Clear’ filter is applied, the undesired rows
will be removed from the spreadsheet. A filter will not remove the rows from the
spreadsheet until the user manually deletes the rows.</i></p>
<ol style="list-style-type: decimal">
<li>To Sort or Filter data, begin by selecting the columns or rows you wish to
filter. To add filters to all columns, click the downward triangle icon
<img src="select_all_excel.png" width="5%" style="background-color: #FFFFFF; padding:2px;">
in the upper lefthand corner of the spreadsheet. This selects all data in the
spreadsheet.</li>
<li>Navigate to the Editing dropdown on the Home tab in Excel.
<img src="sort_and_filter_tab_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>Click ‘Sort &amp; Filter’ for a dropdown and select ‘Filter’. The columns that
were selected will now have a dropdown arrow.</li>
</ol>
<div class="inline-figure"><img src="filter_button_excel.png" width="50%" style="background-color: #41444B; padding:2px;"></div>
<ol start="4" style="list-style-type: decimal">
<li><div class="inline-figure">Select the arrow next to the column you would like to use as a filter. A box
will pop up for the filter selection criteria.
<img src="filter_options_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</div></li>
<li>
<p>Select all necessary criteria and ‘Apply Filter’.</p>
<ol style="list-style-type: lower-alpha">
<li>
<b>Note:</b> if a filter is being used to view and delete unwanted rows, after
applying the filter only the unwanted rows will be left. Select the rows to
be deleted and delete as normal. When the filter is cleared, only the desired
rows will be left in the spreadsheet.</li>
</ol>
</li>
<li><p>To clear a filter and view all rows of data, repeat steps 2 and 3 but select
the ‘Clear’ option instead. All data that was not manually deleted will remain.</p></li>
</ol>
</div>
<div id="fill-empty-data" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Fill Empty Data<a class="anchor" aria-label="anchor" href="#fill-empty-data"><i class="fas fa-link"></i></a>
</h2>
<p><i>The Fill function allows the user to specify criteria to fill in any cells
with missing data. This is a useful tool when certain information is only in one
row of the data, but needs to be entered in all rows with the same Global ID,
PTID, name, etc. </i></p>
<ol style="list-style-type: decimal">
<li>Starting data will look something like below: data for certain columns will
be missing for specific rows. For example, stub information might only appear
for stub events and will not be in the visit rows of data. This information
will be filled using the fill function.</li>
<li>Select the column you need to fill. Press ‘Ctrl + G’ for the ‘Go To’ pop-up
window in Excel. Select ‘Special…’. A new pop-up window will appear. Select
‘Blanks’ and press OK. All empty cells will be highlighted.
<img src="select_empty_cells_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>In the formula bar, enter the formula that matches the necessary criteria to
fill the cell.
<ol style="list-style-type: lower-alpha">
<li>In this example, the formula is saying “If the id in
<span style="color: #0070C0">cell 1-4 (1003)</span> is equal to the id in
<span style="color: #FF0000">cell 1-5 (1003)</span>, then the current cell
equals the sex in <span style="color: #7030A0">cell 2-4 (Male)</span>. Else,
leave the current cell blank (the id in cell 1-4 does not equal the id in cell 1-5).”</li>
</ol>
</li>
<li>Press ‘Ctrl + Enter’ to carry the formula into each empty cell. The Excel
formula will automatically move to the next cells down.
<img src="fill_empty_cells_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>If more than one column needs to be matched before filling the empty cells,
use an AND statement and separate matching criteria by a comma:
<ol style="list-style-type: lower-alpha">
<li>Ex: If both Global ID and PTID needed to be the same to fill in the name
of a participant, use the following statement in the formula bar
(highlighting the cells accordingly):</li>
</ol>
=IF(AND(<span style="color: #0070C0">global_id_cell_1</span>=
<span style="color: #FF0000">global_id_cell_2</span>,
<span style="color: #7030A0">ptid_cell_1</span>=
<span style="color: #00B050">ptid_cell_2</span>),
<span style="color: #ED7D31">sex_cell_1</span>,””)
<ol start="2" style="list-style-type: lower-alpha">
<li>The above statement is saying in plain English: If the
<span style="color: #0070C0">global id of cell 1</span> equals the
<span style="color: #FF0000">global id of cell 2</span> and the
<span style="color: #7030A0">ptid of cell 1</span> equals the
<span style="color: #00B050">ptid of cell 2</span>, then the current cell equals the
<span style="color: #ED7D31">sex of cell 1</span>. Else, leave the current cell
blank (if global ids, or ptids, or both are not the same between the rows).</li>
</ol>
</li>
</ol>
</div>
<div id="delete-empty-rows" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Delete Empty Rows<a class="anchor" aria-label="anchor" href="#delete-empty-rows"><i class="fas fa-link"></i></a>
</h2>
<p><i>The following steps can be used to delete any completely empty rows from a
spreadsheet. This will keep any rows that contain some information. If you
export data and for any reason it has missing rows (see below) this is a quick
and easy trick to remove those.</i>
<img src="empty_rows_excel.png" width="100%" style="background-color: #41444B; padding:2px;"></p>
<ol style="list-style-type: decimal">
<li><p>At the end of the data, add a new column labeled ‘Blanks’.</p></li>
<li>
<p>In the first cell of the ‘Blanks’ column, enter the formula as shown below
for any columns that should contain data.</p>
<ol style="list-style-type: lower-alpha">
<li>Enter ‘=COUNTA()’ in the formula bar.</li>
<li>Within the parenthesis, select all columns in the specific row that
should contain data.</li>
<li>Press ‘Enter’ to enter the formula.
<img src="blanks_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li><div class="inline-figure">Double click or drag the green box in the lower right corner of the cell to
fill down the formula.
<img src="drag_corner_excel.png" width="10%" style="background-color: #41444B; padding:2px;">
Any 0 values indicate that the row is empty. Any value
greater than 0 indicates that at least one column has data.</div></li>
<li>
<p>Filter and delete all blank rows.</p>
<ol style="list-style-type: lower-alpha">
<li>Select the ‘Blanks’ column. Navigate to the filter window. Unselect all
except ‘0’ values.
<img src="delete_blank_rows_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>Select all the rows with 0 values. Left click and select ‘Delete Row’.</li>
</ol>
</li>
<li><p>Clear the filter. All empty rows will now be gone from the spreadsheet.</p></li>
</ol>
</div>
<div id="vlookup" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> VLOOKUP<a class="anchor" aria-label="anchor" href="#vlookup"><i class="fas fa-link"></i></a>
</h2>
<p><i>VLOOKUP uses a lookup value to find certain matches within the same spreadsheet
or in another spreadsheet and return a user-specified value based on the match.
The function takes the form:</i></p>
<p>=VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])</p>
<ol style="list-style-type: decimal">
<li>Before you begin using the formula, determine what you are looking for and what
you will want returned. There are four items you need to fill in for the formula to work:
<ol style="list-style-type: lower-alpha">
<li>lookup_value: the value you are searching for (a single cell)</li>
<li>table_array: the range of the search (typically a column or multiple columns)</li>
<li>col_index_num: the column of the desired return value within the table_array range</li>
<li>range_lookup: TRUE if you want to locate an approximate match to your lookup_value;
FALSE if you want to locate an exact match to your lookup_value</li>
</ol>
</li>
<li>Use the above formula within the first cell where you want the returned value to be entered.</li>
<li>Drag the formula down to perform the VLOOKUP on all cells in a specific column.</li>
</ol>
<p>The following examples will use two separate spreadsheets: one contains a list
of participant ids and demographic information (az_demo); the other contains a
list of participant id’s and visit dates and test scores (az_test).</p>
<div class="inline-figure"><img src="az_demo_test_sheets.png" width="100%" style="background-color: #41444B; padding:2px;"></div>
<p><br></p>
<div id="example-1" class="section level3" number="3.7.1">
<h3>
<span class="header-section-number">3.7.1</span> <b>Example 1:</b><a class="anchor" aria-label="anchor" href="#example-1"><i class="fas fa-link"></i></a>
</h3>
<p><b>Lookup participant id from az_test and add ‘sex’ from the az_demo spreadsheet to the az_test spreadsheet.<b></b></b></p>
<ol style="list-style-type: decimal">
<li>Identify the cell where you want to perform VLOOKUP.
<ol style="list-style-type: lower-alpha">
<li>I want to add ‘sex’ to column N in the az_test spreadsheet</li>
<li>My first cell in column N with a participant id is N2</li>
<li>Optional: add a column name</li>
</ol>
</li>
<li>Enter the following to begin the formula in the cell: =VLOOKUP(
<img src="vlookup_1.1_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>Select the lookup_value and add a comma.
<ol style="list-style-type: lower-alpha">
<li>My first lookup_value is id 1001 from the az_test spreadsheet, so I select cell A2 and add a comma to tell the formula I am ready to proceed.
<img src="vlookup_1.2_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li>Select the table_array (the range of columns where you want Excel to locate the lookup_value and the desired return value).
<ol style="list-style-type: lower-alpha">
<li>My desired return value is ‘sex’ from the az_demo spreadsheet, which means I want Excel to search for my lookup_value in az_demo.
<ol style="list-style-type: lower-roman">
<li>Note: moving to another spreadsheet, you will see that the VLOOKUP formula moves to the formula line of that spreadsheet for ease of use.</li>
</ol>
</li>
<li>My range of columns starts with A (id) and ends with E (sex) in the az_demo spreadsheet, so I select columns A-E.
<img src="vlookup_1.3_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>Add a comma after the columns are selected to tell Excel you are ready to proceed.</li>
</ol>
</li>
<li>Identify the column_index_num of your desired return value within the range of table_array columns.
<ol style="list-style-type: lower-alpha">
<li>table_array number always starts at 1, even if the first column of the range selected is not A.</li>
<li>‘sex’ is the 5th column, so my column_index_num is 5.</li>
<li>Add a comma after the column_index_num to tell Excel you are ready to proceed.
<img src="vlookup_1.4_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li>Enter TRUE or FALSE for your [range_lookup]. FALSE will only look for exact matches.
<ol style="list-style-type: lower-alpha">
<li>Typically, you will always want an exact match, so your [range_lookup] will be FALSE.</li>
<li>In this case, I want an exact match to id 1001 from my az_test spreadsheet to my az_demo spreadsheet, so I enter FALSE.</li>
<li>Add a close parenthesis to finish the formula.
<img src="vlookup_1.5_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li>Press ‘Enter’ and the formula will complete the VLOOKUP.
<ol style="list-style-type: lower-alpha">
<li>I now have the desired return value of sex for id 1001.
<img src="vlookup_1.6_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li>To complete the VLOOKUP for the entire column of id values, drag the green corner to the end of the spreadsheet or double click the small green box when cell N2 is selected, which will automatically drag the formula down.
<img src="vlookup_1.7_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
<p><br></p>
</div>
<div id="example-2" class="section level3" number="3.7.2">
<h3>
<span class="header-section-number">3.7.2</span> <b>Example 2:</b><a class="anchor" aria-label="anchor" href="#example-2"><i class="fas fa-link"></i></a>
</h3>
<p><b>Lookup participant id from az_demo and determine the earliest visit date for each participant from az_test data. <b></b></b></p>
<ol style="list-style-type: decimal">
<li>Identify the cell where you want to perform VLOOKUP.
<ol style="list-style-type: lower-alpha">
<li>I want to add ‘first_visit_date’ to column I in the az_demo spreadsheet</li>
<li>My first cell in column I with a participant id is I2</li>
<li>Optional: add a column name</li>
</ol>
</li>
<li>Enter the following to begin the formula in the cell: =VLOOKUP(
<img src="vlookup_2.1_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>Select the lookup_value and add a comma.
<ol style="list-style-type: lower-alpha">
<li>My first lookup_value is id 1001 from the az_demo spreadsheet, so I select cell A2 and add a comma to tell the formula I am ready to proceed.
<img src="vlookup_2.2_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li>Select the table_array (the range of columns where you want Excel to locate the lookup_value and the desired return value).
<ol style="list-style-type: lower-alpha">
<li>My desired return value is ‘visit_date’ from the az_test spreadsheet, which means I want Excel to search for my lookup_value in az_test
<ol style="list-style-type: lower-roman">
<li>Note: moving to another spreadsheet, you will see that the VLOOKUP formula moves to the formula line of that spreadsheet for ease of use.</li>
</ol>
</li>
<li>My range of columns starts with A (id) and ends with B (visit_date) in the az_test spreadsheet, so I select columns A-B.
<img src="vlookup_2.3_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
<li>Add a comma after the columns are selected to tell Excel you are ready to proceed.</li>
</ol>
</li>
<li>Identify the column_index_num of your desired return value within the range of table_array columns.
<ol style="list-style-type: lower-alpha">
<li>table_array number always starts at 1, even if the first column of the range selected is not A.</li>
<li>Since I want the first visit date, I preface my column_index_num value with the MIN() function.
<ol style="list-style-type: lower-roman">
<li>Note: Other functions can be used to specify which value to return for each id’s visit dates. MAX() will return the latest visit date. AVG() can be used to average test scores for a participant, etc.</li>
</ol>
</li>
<li>‘visit_date’ is the 2nd column, so my column_index_num is 2.</li>
<li>Add a comma after the column_index_num to tell Excel you are ready to proceed.
<img src="vlookup_2.4_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li>Enter TRUE or FALSE for your [range_lookup]. FALSE will only look for exact matches.
<ol style="list-style-type: lower-alpha">
<li>Typically, you will always want an exact match, so your [range_lookup] will be FALSE.</li>
<li>In this case, I want an exact match to id 1001 from my az_test spreadsheet to my az_demo spreadsheet, so I enter FALSE.</li>
<li>Add a close parenthesis to finish the formula.
<img src="vlookup_2.5_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li>Press ‘Enter’ and the formula will complete the VLOOKUP.
<ol style="list-style-type: lower-alpha">
<li>I now have the desired return value of first_visit_date for id 1001.
<img src="vlookup_2.6_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
</li>
<li>To complete the VLOOKUP for the entire column of id values, drag the green corner to the end of the spreadsheet or double click the small green box when cell N2 is selected.
<img src="vlookup_2.7_excel.png" width="100%" style="background-color: #41444B; padding:2px;">
</li>
</ol>
<p>References: <a href="https://support.microsoft.com/en-us/office/vlookup-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1" class="uri">https://support.microsoft.com/en-us/office/vlookup-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1</a></p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="ripple-sop.html"><span class="header-section-number">2</span> Ripple SOP</a></div>
<div class="next"><a href="data-request-sop.html"><span class="header-section-number">4</span> Data Request SOP</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#excel-features-sop"><span class="header-section-number">3</span> Excel Features SOP</a></li>
<li><a class="nav-link" href="#find"><span class="header-section-number">3.1</span> Find</a></li>
<li><a class="nav-link" href="#find-replace"><span class="header-section-number">3.2</span> Find &amp; Replace</a></li>
<li><a class="nav-link" href="#sort-data"><span class="header-section-number">3.3</span> Sort Data</a></li>
<li><a class="nav-link" href="#filter-data"><span class="header-section-number">3.4</span> Filter Data</a></li>
<li><a class="nav-link" href="#fill-empty-data"><span class="header-section-number">3.5</span> Fill Empty Data</a></li>
<li><a class="nav-link" href="#delete-empty-rows"><span class="header-section-number">3.6</span> Delete Empty Rows</a></li>
<li>
<a class="nav-link" href="#vlookup"><span class="header-section-number">3.7</span> VLOOKUP</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#example-1"><span class="header-section-number">3.7.1</span> Example 1:</a></li>
<li><a class="nav-link" href="#example-2"><span class="header-section-number">3.7.2</span> Example 2:</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/nlreiser/Mes-center-dm//blob/main/02-excel-features-sop.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/nlreiser/Mes-center-dm//edit/main/02-excel-features-sop.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Mesulam Center Data Management Practices</strong>" was written by Nina Reiser. It was last built on 2023-06-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
